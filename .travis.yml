language: java
jdk:
- openjdk11
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build pull request
    script: "./gradlew check jacocoTestReport"
    if: type = pull_request
  - stage: build master
    script: "./gradlew check jacocoTestReport publish"
    if: branch = master AND NOT type = pull_request
  - stage: build and stage release
    if: branch =~ /release/
    script: "./gradlew check publish -Pversion=${TRAVIS_BRANCH#'release/'}"
  - stage: release
    if: branch =~ /release/
    script: "./gradlew closeAndReleaseRepository"
  - stage: github release
    if: branch =~ /release/
    script: "./gradlew check -Pversion=${TRAVIS_BRANCH#'release/'} && ./scripts/github-release.sh"
after_success:
- bash <(curl -s https://codecov.io/bash)
before_install:
- |
  if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then
    openssl aes-256-cbc -K $encrypted_d28310a4fc95_key -iv $encrypted_d28310a4fc95_iv -in web3j.asc.enc -out web3j.asc -d
  fi
env:
  global:
  - secure: K8yarMKlQgXHJ/b7VZcAHBDkZxeCPTjNdfldfS0XQa+Iu61GF7m4gaq7Yx+IWd6vc+IQgsrYHEy7x7e3r/WbMpTWlDVGWI9YWU66V7jvP+2GGmfUh7cWOqshO2r+6D1pmj9hSzouEjGr9GoDpekOx/0VhQ92IkSMzk5UnX+F0oAKHtt6UsFUrKWfpnNdpxuQMUrHJNjGXUQaTtknjqzD2v/ZvuPFRIEwp6RTAaC9rjUCgW9L+QQR1rTcrp1N84Jd/Ol0hWY4z6aLf4fQZzq8a51xAotVbwS+OGY+A+dmhS9/mw7t3UJeZpUEoBGC+aMCGie3INwP5fX9ChwX97frlDrErWekDURzBPhMtSePGLQoukWKIjjpRh7sUlIYBVoI8xXVgNqNR+FppOfUzQ05xAIhGZe4SDo2svUWg5sTyFtz9BEzdjUc2O+WtOVP9kL5Xz8QZrMZNMjeybDfC4hqSs6q2+BRbPGbguaQjm6H3abQ2gn8ZoVBpEEYHvZIjymobmhR50tpbJ8vX60TwLv1YdOXjBMiqtfoutF4ur7jOlMgriBbyzHxjJb6CPQ7nAppbU6kjR7dCrIUQeZjYyOxXLUfIkRj10EMu1pN/yf9Zp22X/B6EDrncyGBX2WzAYQMZDSyb7uHruSBQsa6VDNyxx42DbFZt4gsuQGHm5tRh/I=
  - secure: bcDHyXoRQKSKWO6J/lmIHTd64vFHAPTmJZR94fHNWIqFkkSnh1ZPN9XvCVprlm1xxBN0nlnqh64MBgdze00HORGoqR8j5D/LQg6epLoUI56rC+gqGRH9JYN5TadbdDd2YrY7HsuqLvdQX7hgKW0CNB2QQYjBX+Rjz2rZZS14rAs9H11fHhzyGgnBXP96W5Ybt2/duHFbQTJlaXbXdSdK8Sx4nfHBEg6ua3QvZCyUDyEjMz5VgyHvpspUrd2cfYmJoMxGuZjD7usl3XgghtNhD31bVQBKmVq/3Z0dMEb17NtcJgZpA37gk3V3BwaPM6b5m2aQ0ViCtZ4EFcwXn2UBKrpFZiXP0ShTLqwm8cHlL4UsEl9vQ+seIXvJPrZoDab1JTk/U2Kq7Rwyu2b5Ckipp934Gv0Y4Mqe5H5RE9G532LxpQEd+YCBK7HZMU7wL7FxC4j+bTQrJKihHeUOD/ulY8+e4Q12YRy9piZZdDKcD9IHGHlDq+o5iz58r0sawB0865UgUsej6vDxlsMo7NhO9pHUVclVf2d2O+mEfn1wYsy+Jz9zk+W9kL6slARspTgvQAD4IfyE5oX1fKiljk06s5tdcxKccuSbJBH3NJuO7DIlxWtPDp6PPcmX5FrkIn3yppLrCk3vLa4hRiVZkBOIcoyzWia4zO2nJwc4vekDgr0=
  - secure: HekVGdYuCkX39HFIyv23V+ePW2+nv2+zwr4G1SkEZP3r62ZIko8t8lAdqdyEfC5c6AM5AJUnplZ2duQWodsFEfdOgt0h/B0E+oNEWKw7uSxQVklJZKeH9AOpIAwmNIA05xhbNJUNQEgJFiyj/HPrwPULqXAKXV7EhrfRHZKV/DEjZcsR9KBfhOopab+q8sljtiU933/v6BEtqS3m1gb41c9wITTuSvK5KLRof7is6Hkey/YHkLkwXZ+cupttw4S7o+L1uNPB1da1T2xV4irWtxfQM8DJekrAl+oJC3TMGiV8blITJgg+gCeFX579NtQtaWAcd1NlZoBjpud18jfAZdg4Pg8pZMxOrPlS50/5+mTHW8/SA3b/+y4UU5N5sx6ZWc91AqlAWwPUQ+s8B77SBRrYrNpLK8Ekvm/1dlA3jZXyHuJdMbx9wAX5Z0a6RLuBTmNPANzyVQYdiQ1+ss+BAA+zKi5F4DgQxxYkGeOW0hz0PDkKUnbTUkrRVKToRM5ASJGN7amQeCtXTlObCnWYE6WuqBBTrxs+umArNFVTzhyddW/P1yt0cQ8AfhHQzzvigCBxf8LjrUWRJymTnnPOpkgFZICdxjLiqLx2s6NZXtAa7naUBeGNTS9MPtK0HA5p4F19HL/CARi4qVdq2TfC3Lss6t1ReVqBN6YG1/6K9zw=
  - secure: bvySJaO9aeWZi/I6UUoIKtCEg0LMrMTPPZcLVw/jic2zcGkNnq0YrmAJJGuikhVFTdeUa6h1OWaYq9d5WmhJ4O2BjPa6Ibe1nGzTigIdF8PNYKB1eqzYkOA3sx+5mHNRV+FWjwBMS4zgfZxzBZkrKxC+ZpZkKc3Uqh6n2NE+4P8T6OG8CSH93amnDZrmty9dAeHIbBigfoEHoXR//Hrl4kY7/5Z8rSkPsX3LM5SUjyEj3cHCkI8vT2G0SBZLKwg3hB29ZmBHLN+uWiykkUPIVKQgt3J6eh59RipuNOzxOBvfoMREjF5Ctg3SsRiixVpx+EK4U7Wcsx4r8HYTnl2ES1aGHwMcoRuvoBDZXlN2//O02J69s1XyN6fHdVEeIkrN6MfRu0mvZbGqPNYRU/OypAlhVA3ICSZQzRH4hKXgqrZHgToJotBOQRBnp4zPH80OD+eYpL4ZbehjBOqfHiM6co80n4cGbYAYEg1DC1Gi7pbj1FSCnxb8FsTlQ5rQSsXqJ2KPH2keCvyw9wOGwlpmLTQfPWV8FZk2v6KvsjyiRv/mhgRQH2jKDSQ5MmiMcjQl3vcVZD06pkoLsVFUYCAzS4+k1bp4XPAxmotiWiMwvdKrNXi4QFK8PEW8OTP9Z3atTFuqQKP2iWxqI2j+nTsCg/rsjC2c52exI6/4vw+9GTM=
