language: java
jdk:
- openjdk11
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build pull request
    script: "./gradlew check jacocoTestReport"
    if: type = pull_request
  - stage: build master
    script: "./gradlew check jacocoTestReport publish"
    if: branch = master AND NOT type = pull_request
  - stage: build and stage release
    if: branch =~ /release/
    script: "./gradlew check publish -Pversion=${TRAVIS_BRANCH#'release/'}"
  - stage: release
    if: branch =~ /release/
    script: "./gradlew closeAndReleaseRepository"
  - stage: github release
    if: branch =~ /release/
    script: "./gradlew check -Pversion=${TRAVIS_BRANCH#'release/'} && ./scripts/github-release.sh"
after_success:
- bash <(curl -s https://codecov.io/bash)
before_install:
- |
  if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then
    openssl aes-256-cbc -K $encrypted_d28310a4fc95_key -iv $encrypted_d28310a4fc95_iv -in web3j.asc.enc -out web3j.asc -d
  fi
env:
  global:
  - secure: AMZQfm2eh3EqkiaoJxJrkDZIy6owrGGueRQSy4EIERNPFcQT9ggTyesi4cEVarxCGdBqys/A00fF1R6nBuYMtoQPIUNHIr/Eqd7aJ2UjowoZjWWuV7gFzMLjXRXH1WoY2LDQQ9I1lsAQ7c+iGBXQHpj2zTqoB9Di/JAWw2cHlLZcfH90nVuDiKGFeJ/RAOetptjadK/cBZbAt5rUXKMHB2gBZMehu1t/cFRlPQ7hAclHad1UDsOGEVAEPDvYbVpWQZxtChopZSCdCl5FjU8hZFIbjaEHx8O965hHQHaEksy8YwO1ltRop7/aGL+retVoJShq3O/Ps8j6oqePwv8axMrh6gI4Eo9p9x+lpoFDD+3MDq8M54v7GYAs1ZHZGB1974BVpqA4JZzjkHjnOHrVP3IzPfPvNJX8MWb6nSxkWCakqzQj9APi/85FOB7Rm6sOw+iGvWp/ECrqf3okmDHaKZLH3WiHZJ06lPoBhHEuWDoAbAXPcpPnVm5P9ua1lTcn8LFavX2yKl54N9bcrILtxd05XkdOApjNfoVWeM4DrwmaBz6S4DrMrRRlnr5RPaxJweXJdHcx0mOQ5S7dsEk3FGEbDths86SUeg55H3foOkPN7dgJ/d5x5GWOFEt901z/BEnsIuzi+JDof6LE8EtLIfBE6JYz+yCwglEb0IuXgVc=
  - secure: JNjUUeqhg/hNDvlgziuKpp3JJc2oIbjbr7W09JQnKD45bMJZbHG7M8PXBHTS3xC7GM/XBSXAAIWqC9Ow/C9ZkaF1LBKMdM+RFhtKsHXef5VCn12qjGZo7DgYYMexNJ7JoqGYGUIwiicArdq/8BjXXk0FakZL69yd7FNQeZWbqt76u2ng6rZZGLOGFjfdwINFu5nCPGcbIN2JOw2VFCdRQMHiHoNJULYjOdyzh1gFTNQq15fcYfM6PBoRx3BymgjGV4x122voF/2dVQtKLRkAqxMcTccT9ySFsWCxReCwLQWGvrez6cc2XgjhmqbLs/QJyrvLlbnPowNiLUV3BeWv93hsavbMa+bsSD/iMrslenu80Qwc1Wwr6i10LOAW+urxitKrwkVjqE3gYrA3RjXVN/xyP81FxRMJWVyeS0bFTsmPADpWtuW+zIZBLgvlVSau+/qi9Kr0DUv9IVYkqo4K6Z0veblBsNkN+wiV5hkAzTkAyV+i+vZC+fPxRmfhB/4+lrMwAzos1nm1s484rekCB4pIiQSE8BdNl48dXYOn9f1uK3XID5IkGuH7FEckMdpyU4y0UAZNtqFo24QNF42PbtC86SQa6jwdZHNsXAmzOgJUAPaHtpdNB71QPeVwh2gGG8ka8usxlV+yh/3oRMDhcUtRweU23Q9nMYeZtqClyhE=
  - secure: Q5VxtnAagaSNvMrDeKjWbWa4ENLrkkinjI+4MBAyflemWvjZvx+4s2WZg4ZxPLAhIp4YFuGVbXxd+JwZSFxk2jkpU6lppFzdjAOM+0B+iSPd92eMIXeiwkPufavjYfQ4oX2tKcT6OnG3F3DCyj5/aeoc/zsZajzH9WCLQMrPwXqJXNnIfwZEjfdwnfJYzC1/5q7ptMoA48iK5CpXQeoPaZmLT/LlwEXCQXQJgtZvg9LnMW3fOg6AjwHb54xBaRRORinPEPzi6AThHVvdwBpKVObGPSb5eEeTbo9pA8ZEeItPxPamqEfsAnJFEXvGz8mE32mpLugcPQLR9SMr3GVwYkddq8ZFXWCDV52iqNjcHZ9+xP0Mbnf+/uOR+Hh4ajT05ZeUBNymdh2ceO/8m0Sv0LzdLIZwrAhLko6qkE4dIEe/8+HaArHzR+sAjlV2+iQDul9Y/AURbDb8OFdROUarEuNF4Sa4avG4m01ZPLqffy2KOJr0yAv/eAEtC0IbhRUo0yrfOxa6usVRIMDNr/CDbZKY6uBVRZK7wOk7uycNBtrGQBHqdTM8gSoGS+rzGYBdV2nfHXXdTxwzStSSG2sBAr8k6l2IxAlN1CJWrx7G1GhKdXV6kMH1hbE/5uGL4LtBHoD42oCDJdQ0j9MdtPcLb37Scrrj/XtNuNr8u2Yvib0=
  - secure: CKwkJC4wnaEgNUUdtZb5D7CcQeS87eH0Os8bHVaKYtUgQASzU10CI8Iuakym/XPvW6c2sCJLI6sLTKyo+jNiHfG5oOdaR0oX4elnVbMRpB9V/79ua/BxiRHPkVXrdy3WW+pVG67aXg5ZHOwDmu6T++dFOhJPet5xqItYN3+YUh/roix0/kTjXzvfqVm+9PQwR80o1o2aBuv9dwXfPbUGGxUhwSnfxdy2GiMPu/laOrE0Khzsg+cUyN6ku9ykY6mPds3FGrhySqaxVVBmfhRrj7Jf0ieM9gGBHCvG5vxxnuHVn2XP33Pn/Cs0SOFv8EJ+XEd0yJj7GTGohsNqZCHD9llfh1KbhS0nYuj9CLP8Z1/x1lU4KHcW6mMzlkjTTsLYV/ylJjD5WLYQO2qccGARU3sevvH5CEQlJy/ofXnmR91j/Sjks+9ydUaCRBn7Zl0kOg37oTmzwjNczDuT6oOvqoa8uEi3z91EW6UcPAD1hzHWdnnX7JbWjAFlcTbR2OQkVzDokjYG4/SFQAHvr+Wf1oG4cmBlb24rBcNFYDZsec6cYo2pok/SraBVOU6q9quteRHwWNuYHEJknPB0t+FiB2jSl8QR44irJOlexyQJjDHjHiQ14fKUMNDi9OAA4OSFKkkGZZFOiSVjZz34BLoufb2zUz/z4za51gF4Ihj4iTg=
